---
import { i18n } from "astro:config/client";
import Base from "$layouts/Base.astro";
import i18nit from "$i18n";

export async function getStaticPaths() {
	return i18n?.locales.map(locale => ({ params: { locale: locale == i18n?.defaultLocale ? undefined : (locale as string) } }));
}

const { locale = i18n!.defaultLocale } = Astro.params;

const t = i18nit(locale);
---

<style lang="less">
	:root {
		/* Airy vertical rhythm for About page */
		--about-rhythm: clamp(64px, 14vw, 180px);
	}

	main {
		/* Full-height grid with generous vertical breathing */
		padding-block: var(--about-rhythm);
		padding-inline: clamp(20px, 6vw, 140px);
		/* Centered narrow column (verse measure) */
		max-width: 48ch; /* 46–50ch */
		margin-inline: auto;

		display: grid;
		grid-template-rows: auto 1fr auto;
		row-gap: calc(var(--about-rhythm) * 0.5);
	}

	article {
		/* Match typography from markdown.less (At Twenty-Five) */
		font-weight: 300;
		font-size: 18px;
		line-height: 1.8;
		letter-spacing: 0.02em;
		color: var(--text-color, var(--primary-color));
        
		h1 {
			/* Match article title scale from At Twenty-Five */
			font-size: 1.5rem;
			font-weight: 400;
			text-align: center;
			margin: 0;
		}

		:global(p) {
			margin: 0 0 1.25rem 0;
			font-weight: 300;
			font-size: 18px;
			text-align: left;
			text-justify: auto;
			-webkit-hyphens: auto;
			-ms-hyphens: auto;
			hyphens: auto;
			text-align-last: left;
			letter-spacing: 0.02em;
		}

		:global(hr) {
			border-bottom: 1px dashed var(--remark-color);
			margin: 1rem 0;
		}

		/* Verse lines and footnote */
		.verse { margin-top: calc(var(--about-rhythm) * 0.5); }
		.verse-line { display: block; margin: 0; }
		.verse-line + .verse-line { margin-top: 1.2lh; } /* ~1.2 line-heights gap */

		.footnote-trigger { position: relative; cursor: help; outline: none; }
		.footnote-trigger::after {
			content: attr(data-footnote);
			position: absolute;
			left: 50%;
			bottom: calc(100% + 8px);
			transform: translateX(-50%);
			white-space: nowrap;
			background-color: var(--background-color);
			border: 1px solid var(--shadow-color);
			border-radius: 4px;
			padding: 0.45rem 0.65rem;
			font-size: 0.85rem;
			line-height: 1.4;
			color: var(--secondary-color);
			box-shadow: 0 2px 10px rgba(0,0,0,.08);
			opacity: 0;
			visibility: hidden;
			pointer-events: none;
			transition: opacity .2s ease-in-out, visibility .2s ease-in-out;
			z-index: 5;
		}
		.footnote-trigger:hover::after,
		.footnote-trigger:focus::after,
		.footnote-trigger:active::after { opacity: 1; visibility: visible; }
	}
</style>

<Base title={t("navigation.about")} {locale}>
	<main>
			<article aria-labelledby="why-i-write">
				<h1 id="why-i-write">Why I write</h1>
				<div class="verse" role="group" aria-label="Verse lines">
					<span class="verse-line">You don’t yet understand the subtleties of time.</span>
					<span class="verse-line">It doesn’t only slip away — it folds back,</span>
					<span class="verse-line">like the tide rising to the shore.</span>
					<span class="verse-line">I want to write time down.<span class="footnote-trigger" tabindex="0" role="note" aria-label="Footnote" data-footnote="— From Rain (《雨》) by 黃錦樹."></span></span>
				</div>
			</article>
	</main>
</Base>
